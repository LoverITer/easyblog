/*!
 * Preformatted text dialog plugin for Editor.md
 *
 * @file        preformatted-text-dialog.js
 * @author      pandao
 * @version     1.2.0
 * @updateTime  2015-03-07
 * {@link       https://github.com/pandao/editor.md}
 * @license     MIT
 */
(function(){var a=function(b){var d;var c="preformatted-text-dialog";b.fn.preformattedTextDialog=function(){var j=this;var q=this.cm;var e=this.lang;var k=this.editor;var g=this.settings;var s=q.getCursor();var p=q.getSelection();var r=this.classPrefix;var h=e.dialog.preformattedText;var f=r+c,l;q.focus();if(k.find("."+f).length>0){l=k.find("."+f);l.find("textarea").val(p);this.dialogShowMask(l);this.dialogLockScreen();l.show()}else{var o='<textarea placeholder="'+h.placeholder+'" style="display:none;">'+p+"</textarea>";l=this.createDialog({name:f,title:h.title,width:780,height:540,mask:g.dialogShowMask,drag:g.dialogDraggable,content:o,lockScreen:g.dialogLockScreen,maskStyle:{opacity:g.dialogMaskOpacity,backgroundColor:g.dialogMaskBgColor},buttons:{enter:[e.buttons.enter,function(){var u=this.find("textarea").val();if(u===""){alert(h.emptyAlert);return false}u=u.split("\n");for(var t in u){u[t]="    "+u[t]}u=u.join("\n");if(s.ch!==0){u="\r\n\r\n"+u}q.replaceSelection(u);this.hide().lockScreen(false).hideMask();return false}],cancel:[e.buttons.cancel,function(){this.hide().lockScreen(false).hideMask();return false}]}})}var m={mode:"text/html",theme:g.theme,tabSize:4,autofocus:true,autoCloseTags:true,indentUnit:4,lineNumbers:true,lineWrapping:true,extraKeys:{"Ctrl-Q":function(t){t.foldCode(t.getCursor())}},foldGutter:true,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"],matchBrackets:true,indentWithTabs:true,styleActiveLine:true,styleSelectedText:true,autoCloseBrackets:true,showTrailingSpace:true,highlightSelectionMatches:true};var n=l.find("textarea");var i=l.find(".CodeMirror");if(l.find(".CodeMirror").length<1){d=b.$CodeMirror.fromTextArea(n[0],m);i=l.find(".CodeMirror");i.css({"float":"none",margin:"0 0 5px",border:"1px solid #ddd",fontSize:g.fontSize,width:"100%",height:"410px"});d.on("change",function(t){n.val(t.getValue())})}else{d.setValue(q.getSelection())}}};if(typeof require==="function"&&typeof exports==="object"&&typeof module==="object"){module.exports=a}else{if(typeof define==="function"){if(define.amd){define(["editormd"],function(b){a(b)})}else{define(function(c){var b=c("./../../editormd");a(b)})}}else{a(window.editormd)}}})();